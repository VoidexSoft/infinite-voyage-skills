{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "InfiniteVoyageItemExport",
  "description": "Schema for exporting item data from the game data spreadsheet into the Infinite Voyage engine runtime format. All items must conform to this schema for the engine to load them.",
  "type": "object",
  "properties": {
    "export_version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of the export format (e.g., 1.0.0)"
    },
    "exported_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when this export was generated"
    },
    "items": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^item_[a-z]+_\\d{3}$",
            "description": "Unique item identifier matching pattern item_<type>_<number>"
          },
          "display_name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 64
          },
          "category": {
            "type": "string",
            "enum": ["weapon", "armor", "consumable", "quest_item", "crafting_material"]
          },
          "rarity": {
            "type": "integer",
            "minimum": 0,
            "maximum": 4,
            "description": "0=Common, 1=Uncommon, 2=Rare, 3=Epic, 4=Legendary"
          },
          "level_requirement": {
            "type": "integer",
            "minimum": 0,
            "maximum": 50
          },
          "stats": {
            "type": "object",
            "properties": {
              "damage": { "type": "number", "minimum": 0 },
              "defense": { "type": "number", "minimum": 0 },
              "dodge_bonus": { "type": "number", "minimum": 0, "maximum": 100 },
              "hp_restore": { "type": "number", "minimum": 0 },
              "shield_bonus": { "type": "number", "minimum": 0 },
              "speed_modifier": { "type": "number", "minimum": -100, "maximum": 100 }
            },
            "additionalProperties": false
          },
          "special_effect": {
            "type": ["object", "null"],
            "properties": {
              "effect_id": { "type": "string" },
              "description": { "type": "string" },
              "parameters": {
                "type": "object",
                "additionalProperties": { "type": "number" }
              }
            },
            "required": ["effect_id", "description", "parameters"]
          },
          "economy": {
            "type": "object",
            "properties": {
              "buy_price": { "type": "integer", "minimum": 0 },
              "sell_price": { "type": "integer", "minimum": 0 },
              "is_tradeable": { "type": "boolean" },
              "is_stackable": { "type": "boolean" },
              "max_stack": { "type": "integer", "minimum": 1 }
            },
            "required": ["buy_price", "sell_price", "is_tradeable", "is_stackable", "max_stack"]
          },
          "drop_sources": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "source_type": {
                  "type": "string",
                  "enum": ["enemy", "chest", "quest", "craft", "vendor"]
                },
                "source_id": { "type": "string" },
                "drop_rate": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "description": "Probability as 0.0-1.0 float"
                }
              },
              "required": ["source_type", "source_id", "drop_rate"]
            }
          },
          "asset_ref": {
            "type": "string",
            "pattern": "^art/items/[a-z0-9_]+\\.(png|jpg)$"
          }
        },
        "required": ["id", "display_name", "category", "rarity", "level_requirement", "stats", "economy", "asset_ref"],
        "additionalProperties": false
      }
    }
  },
  "required": ["export_version", "items", "exported_at"],
  "additionalProperties": false
}
